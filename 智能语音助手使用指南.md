# 智能助手使用指南

## 功能介绍

智能助手是一个基于通义千问大模型的自然语言任务管理工具，通过文字输入，智能理解用户意图，自动批量添加巡检任务。

## 快速开始

### 1. 启动系统

确保Web服务已启动：
```bash
cd web_frontend
python app.py
```

或使用项目根目录的启动脚本：
```bash
python start_all.py
```

### 2. 打开Web界面

浏览器访问: `http://localhost:5000`

### 3. 使用智能助手

1. 在左侧边栏"任务管理"区域顶部，点击 **🤖 智能助手** 按钮
2. 弹窗会出现，显示文本输入框
3. 输入您的任务需求（参考下方示例）
4. 点击 **📤 发送** 按钮
5. 系统会自动解析并批量添加任务
6. 任务添加成功后，窗口会在2秒后自动关闭

## 输入示例

### 按任务类型
```
输入: "检查压力表和物品识别"
结果: 自动添加任务1(指针仪表) + 任务5(物品描述)
```

```
输入: "温度和烟雾"
结果: 自动添加任务2(温度检测) + 任务3(烟雾A) + 任务4(烟雾B)
```

### 按站点编号
```
输入: "检查站点1和站点5"
结果: 自动添加站点1和站点5的任务
```

```
输入: "站点2"
结果: 自动添加站点2的温度检测任务
```

### 全面检查
```
输入: "全部检查一遍"
结果: 自动添加全部5个任务
```

```
输入: "完整巡检"
结果: 自动添加全部5个任务
```

### 单独任务
```
输入: "指针仪表"
结果: 自动添加任务1
```

```
输入: "烟雾监测"
结果: 自动添加任务3和任务4
```

## 任务对照表

| 任务类型 | 站点ID | 任务名称 | 关键词 |
|---------|--------|----------|--------|
| 任务1 | 站点1 | 指针仪表读数 | 指针、仪表、压力表 |
| 任务2 | 站点2 | 温度检测 | 温度、高温、测温 |
| 任务3 | 站点3 | 烟雾监测A | 烟雾A、烟A、烟雾 |
| 任务4 | 站点4 | 烟雾监测B | 烟雾B、烟B、烟雾 |
| 任务5 | 站点5 | 物品描述 | 物品、物体、识别 |

## 功能特点

### ✅ 自然语言理解
- 支持自然语言输入，无需记忆命令格式
- 智能识别任务类型和站点编号
- 支持多种表达方式

### ✅ 批量任务添加
- 一次输入可添加多个任务
- 自动去重，避免重复添加
- 显示添加结果统计

### ✅ 实时反馈
- 显示意图解析进度
- 显示任务添加状态
- 成功后自动刷新任务列表
- 任务添加完成后2秒自动关闭窗口

### ✅ 美观界面
- 现代化UI设计
- 简洁清晰的布局
- 响应式设计

## 技术实现

### 后端
- **意图解析**: 通义千问(qwen-plus)文本模型
- **API接口**: Flask REST API
- **降级方案**: 关键词匹配（当大模型不可用时）

### 前端
- **界面框架**: 原生JavaScript
- **样式设计**: CSS3动画
- **交互体验**: 自动关闭、实时反馈

## 配置说明

### 配置要求
系统已完整配置，无需额外设置：
- ✅ DASHSCOPE_API_KEY (通义千问API密钥)

## 常见问题

### Q: 点击发送后没有反应？
A: 请检查：
1. Web服务是否正常运行
2. 浏览器控制台是否有错误信息
3. DASHSCOPE_API_KEY是否配置正确

### Q: 窗口会自动关闭吗？
A: 是的，任务添加成功后，窗口会在2秒后自动关闭并返回主界面。

### Q: 如何提高识别准确率？
A: 建议：
1. 使用任务对照表中的关键词
2. 输入清晰明确的需求
3. 一次不要输入过多任务

### Q: 能否自定义任务类型？
A: 当前版本支持固定的5种任务类型，对应5个站点。如需增加任务类型，需要修改配置文件。

### Q: 关闭按钮在哪里？
A: 弹窗右上角有 × 按钮，点击即可关闭。任务添加成功后也会自动关闭。

## 测试结果

意图解析准确率: **100%** (6/6测试用例通过)

详细测试报告: 请参考 `web_frontend/VOICE_ASSISTANT_TEST.md`

## 技术支持

如有问题，请查看：
1. 项目文档: `智能巡检服务端需求文档.md`
2. 测试报告: `web_frontend/VOICE_ASSISTANT_TEST.md`
3. 架构说明: `api_server/架构说明.md`

