# RaspiCart - Waveshare UGV æœºå™¨äººæ§åˆ¶ç³»ç»Ÿ

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

RaspiCart æ˜¯åŸºäºæ ‘è“æ´¾çš„æ™ºèƒ½æœºå™¨äººå°è½¦æ§åˆ¶ç³»ç»Ÿï¼Œä¸“ä¸º Waveshare ç³»åˆ— UGV æœºå™¨äººè®¾è®¡ï¼ŒåŒ…æ‹¬ **WAVE ROVER**ã€**UGV Rover**ã€**UGV Beast**ã€**RaspRover**ã€**UGV01**ã€**UGV02** ç­‰å‹å·ã€‚

æœ¬é¡¹ç›®é‡‡ç”¨ä¸Šä¸‹ä½æœºæ¶æ„ï¼Œæ ‘è“æ´¾ä½œä¸ºä¸Šä½æœºè¿è¡Œæœ¬ç¨‹åºï¼Œè´Ÿè´£ AI è§†è§‰å¤„ç†ã€ç­–ç•¥è§„åˆ’å’Œ Web ç•Œé¢æœåŠ¡ï¼›ESP32 ä½œä¸ºä¸‹ä½æœºè´Ÿè´£åº•å±‚è¿åŠ¨æ§åˆ¶å’Œä¼ æ„Ÿå™¨æ•°æ®å¤„ç†ï¼Œä¸¤è€…é€šè¿‡ GPIO UART è¿›è¡Œ JSON æ ¼å¼é€šä¿¡ã€‚

### æ ¸å¿ƒç‰¹æ€§

- ğŸ¥ **å®æ—¶è§†é¢‘ä¼ è¾“**ï¼šåŸºäº WebRTC çš„ä½å»¶è¿Ÿè§†é¢‘æµ
- ğŸ¤– **AI è§†è§‰åŠŸèƒ½**ï¼šç‰©ä½“è¯†åˆ«ã€äººè„¸æ£€æµ‹ã€æ‰‹åŠ¿è¯†åˆ«ã€é¢œè‰²è¿½è¸ª
- ğŸ® **Web æ§åˆ¶ç•Œé¢**ï¼šè·¨å¹³å°çš„ Flask Web åº”ç”¨
- ğŸ“š **äº¤äº’å¼æ•™ç¨‹**ï¼šåŸºäº JupyterLab çš„ä¸°å¯Œæ•™ç¨‹ç³»ç»Ÿ
- ğŸ”Š **éŸ³é¢‘äº¤äº’**ï¼šTTS è¯­éŸ³åˆæˆä¸éŸ³é¢‘æ’­æ”¾
- ğŸ¯ **è‡ªåŠ¨è¿½è¸ª**ï¼šåŸºäºè§†è§‰çš„ç›®æ ‡è¿½è¸ªä¸å·¡çº¿

---

## ğŸ“ é¡¹ç›®æ–‡ä»¶ç»“æ„

```
RaspiCart/
â”œâ”€â”€ app.py                          # ä¸»ç¨‹åºå…¥å£ï¼ˆFlask åº”ç”¨ï¼‰
â”œâ”€â”€ base_ctrl.py                    # åº•ç›˜æ§åˆ¶æ¨¡å—
â”œâ”€â”€ cv_ctrl.py                      # è®¡ç®—æœºè§†è§‰æ§åˆ¶æ¨¡å—
â”œâ”€â”€ audio_ctrl.py                   # éŸ³é¢‘æ§åˆ¶æ¨¡å—
â”œâ”€â”€ os_info.py                      # ç³»ç»Ÿä¿¡æ¯è·å–æ¨¡å—
â”œâ”€â”€ config.yaml                     # é…ç½®æ–‡ä»¶
â”œâ”€â”€ requirements.txt                # Python ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ setup.sh                        # å®‰è£…è„šæœ¬
â”œâ”€â”€ autorun.sh                      # å¼€æœºè‡ªå¯åŠ¨è„šæœ¬
â”œâ”€â”€ start_jupyter.sh                # Jupyter Lab å¯åŠ¨è„šæœ¬
â”‚
â”œâ”€â”€ models/                         # AI æ¨¡å‹æ–‡ä»¶
â”‚   â”œâ”€â”€ deploy.prototxt             # MobileNet é…ç½®
â”‚   â”œâ”€â”€ mobilenet_iter_73000.caffemodel  # ç‰©ä½“è¯†åˆ«æ¨¡å‹
â”‚   â””â”€â”€ haarcascade_frontalface_default.xml  # äººè„¸æ£€æµ‹æ¨¡å‹
â”‚
â”œâ”€â”€ templates/                      # Web ç•Œé¢èµ„æº
â”‚   â”œâ”€â”€ index.html                  # ä¸»æ§åˆ¶é¡µé¢
â”‚   â”œâ”€â”€ video.html                  # è§†é¢‘é¡µé¢
â”‚   â”œâ”€â”€ photo.html                  # ç…§ç‰‡ç®¡ç†é¡µé¢
â”‚   â”œâ”€â”€ settings.html               # è®¾ç½®é¡µé¢
â”‚   â”œâ”€â”€ main.js                     # å‰ç«¯ä¸»é€»è¾‘
â”‚   â”œâ”€â”€ control.js                  # æ§åˆ¶é€»è¾‘
â”‚   â”œâ”€â”€ style.css                   # æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ pictures/                   # ç…§ç‰‡å­˜å‚¨ç›®å½•
â”‚   â”œâ”€â”€ videos/                     # è§†é¢‘å­˜å‚¨ç›®å½•
â”‚   â””â”€â”€ img/                        # å›¾æ ‡èµ„æº
â”‚
â”œâ”€â”€ sounds/                         # éŸ³é¢‘æ–‡ä»¶
â”‚   â”œâ”€â”€ connected/                  # è¿æ¥æˆåŠŸéŸ³æ•ˆ
â”‚   â”œâ”€â”€ robot_started/              # å¯åŠ¨éŸ³æ•ˆ
â”‚   â””â”€â”€ others/                     # å…¶ä»–éŸ³é¢‘æ–‡ä»¶
â”‚
â”œâ”€â”€ tutorial_cn/                    # ä¸­æ–‡æ•™ç¨‹ï¼ˆJupyterLabï¼‰
â”‚   â”œâ”€â”€ 01 JupyterLab åŸºç¡€å’Œæœºå™¨äººä»‹ç».ipynb
â”‚   â”œâ”€â”€ 02 Python åº•ç›˜è¿åŠ¨æ§åˆ¶.ipynb
â”‚   â”œâ”€â”€ 03 äº‘å°æ§åˆ¶å’Œ LED ç¯æ§åˆ¶.ipynb
â”‚   â”œâ”€â”€ 04 OLED å±å¹•æ§åˆ¶.ipynb
â”‚   â”œâ”€â”€ 05 åœ¨ JupyterLab ä¸­æ„å»º UI ç•Œé¢.ipynb
â”‚   â”œâ”€â”€ 06 è·å–åº•ç›˜åé¦ˆä¿¡æ¯.ipynb
â”‚   â”œâ”€â”€ 07 ä½¿ç”¨ JSON æŒ‡ä»¤æ§åˆ¶ä¸‹ä½æœº.ipynb
â”‚   â”œâ”€â”€ 08 ä¸‹ä½æœº JSON æŒ‡ä»¤é›†.ipynb
â”‚   â”œâ”€â”€ 09 å¼€æœºè‡ªåŠ¨å‘é€æŒ‡ä»¤.ipynb
â”‚   â”œâ”€â”€ 10 æ’­æ”¾éŸ³é¢‘æ–‡ä»¶.ipynb
â”‚   â”œâ”€â”€ 11 æ–‡å­—è½¬è¯­éŸ³ (TTS).ipynb
â”‚   â”œâ”€â”€ 12 ä½¿ç”¨ Flask å®ç°ä½å»¶æ—¶å›¾ä¼ .ipynb
â”‚   â”œâ”€â”€ 13 åœ¨ Jupyter Lab ä¸­æ˜¾ç¤ºå®æ—¶ç”»é¢.ipynb
â”‚   â”œâ”€â”€ 14 å»¶æ—¶æ‘„å½±.ipynb
â”‚   â”œâ”€â”€ 15 OpenCV è¿åŠ¨æ£€æµ‹.ipynb
â”‚   â”œâ”€â”€ 16 é€šè¿‡æŒ‰é”®æ§åˆ¶æ‹ç…§.ipynb
â”‚   â”œâ”€â”€ 17 OpenCV äººè„¸è¯†åˆ«.ipynb
â”‚   â”œâ”€â”€ 18 åŸºäº DNNï¼ˆæ·±åº¦ç¥ç»ç½‘ç»œï¼‰çš„ç‰©ä½“è¯†åˆ«.ipynb
â”‚   â”œâ”€â”€ 19 åŸºäº OpenCV çš„é¢œè‰²è¯†åˆ«.ipynb
â”‚   â”œâ”€â”€ 19 åŸºäº OpenCV çš„é¢œè‰²è¿½è¸ª.ipynb
â”‚   â”œâ”€â”€ 20 åŸºäº MediaPipe çš„æ‰‹åŠ¿è¯†åˆ«.ipynb
â”‚   â”œâ”€â”€ 21 åŸºäº OpenCV çš„å·¡çº¿è‡ªåŠ¨é©¾é©¶.ipynb
â”‚   â”œâ”€â”€ 22 åŸºäº MediaPipe çš„äººè„¸è¯†åˆ«.ipynb
â”‚   â”œâ”€â”€ 23 åŸºäº MediaPipe çš„å§¿æ€æ£€æµ‹.ipynb
â”‚   â”œâ”€â”€ 24 ç®€æ˜“çš„ WEB åº”ç”¨.ipynb
â”‚   â”œâ”€â”€ 25 ä¸»ç¨‹åºæ¶æ„ä»‹ç».ipynb
â”‚   â”œâ”€â”€ 26 YAML é…ç½®æ–‡ä»¶è®¾ç½®.ipynb
â”‚   â”œâ”€â”€ 27 Crontab å¼€æœºè‡ªåŠ¨è¿è¡Œè„šæœ¬.ipynb
â”‚   â”œâ”€â”€ 28 è‡ªå®šä¹‰å‘½ä»¤è¡ŒåŠŸèƒ½.ipynb
â”‚   â””â”€â”€ 29 WEB å‘½ä»¤è¡Œåº”ç”¨.ipynb
â”‚
â”œâ”€â”€ tutorial_en/                    # è‹±æ–‡æ•™ç¨‹ï¼ˆJupyterLabï¼‰
â”‚   â””â”€â”€ [å¯¹åº”çš„è‹±æ–‡æ•™ç¨‹æ–‡ä»¶]
â”‚
â”œâ”€â”€ AccessPopup/                    # WiFi çƒ­ç‚¹ç®¡ç†å·¥å…·
â”‚   â””â”€â”€ installconfig.sh            # å®‰è£…é…ç½®è„šæœ¬
â”‚
â””â”€â”€ ugv-env/                        # Python è™šæ‹Ÿç¯å¢ƒ
    â””â”€â”€ [è™šæ‹Ÿç¯å¢ƒæ–‡ä»¶]
```

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ·è®¾å¤‡å±‚                            â”‚
â”‚  (æ‰‹æœº/ç”µè„‘æµè§ˆå™¨ é€šè¿‡ WiFi/ä»¥å¤ªç½‘ è®¿é—® Web ç•Œé¢)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ HTTP/WebSocket/WebRTC
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ä¸Šä½æœº (æ ‘è“æ´¾) - RaspiCart                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚            Flask Web åº”ç”¨ (app.py)                â”‚  â”‚
â”‚  â”‚  - HTTP è·¯ç”± (æ§åˆ¶ç•Œé¢ã€æ–‡ä»¶ç®¡ç†)                 â”‚  â”‚
â”‚  â”‚  - WebSocket (å®æ—¶åŒå‘é€šä¿¡)                       â”‚  â”‚
â”‚  â”‚  - WebRTC (ä½å»¶è¿Ÿè§†é¢‘æµ)                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                          â†•                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ CV è§†è§‰æ¨¡å—   â”‚  â”‚ éŸ³é¢‘æ¨¡å—     â”‚  â”‚ ç³»ç»Ÿä¿¡æ¯æ¨¡å—  â”‚ â”‚
â”‚  â”‚ (cv_ctrl.py) â”‚  â”‚(audio_ctrl.pyâ”‚  â”‚ (os_info.py) â”‚ â”‚
â”‚  â”‚              â”‚  â”‚)             â”‚  â”‚              â”‚ â”‚
â”‚  â”‚ - OpenCV     â”‚  â”‚ - pygame     â”‚  â”‚ - CPU/å†…å­˜   â”‚ â”‚
â”‚  â”‚ - MediaPipe  â”‚  â”‚ - pyttsx3    â”‚  â”‚ - ç½‘ç»œçŠ¶æ€   â”‚ â”‚
â”‚  â”‚ - ç›®æ ‡è¿½è¸ª   â”‚  â”‚ - TTS        â”‚  â”‚ - æ¸©åº¦ç›‘æ§   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â†•                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚      åº•ç›˜æ§åˆ¶æ¨¡å— (base_ctrl.py)                  â”‚  â”‚
â”‚  â”‚  - ä¸²å£é€šä¿¡ç®¡ç† (Serial)                          â”‚  â”‚
â”‚  â”‚  - JSON æŒ‡ä»¤å°è£…ä¸å‘é€                            â”‚  â”‚
â”‚  â”‚  - æ•°æ®åé¦ˆæ¥æ”¶ä¸è§£æ                             â”‚  â”‚
â”‚  â”‚  - äº‘å°/æœºæ¢°è‡‚/OLED/LED æ§åˆ¶                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ UART (GPIO Serial)
                         â”‚ JSON æ ¼å¼é€šä¿¡
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ä¸‹ä½æœº (ESP32) - ugv_base                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  - ç”µæœºé©±åŠ¨æ§åˆ¶                                          â”‚
â”‚  - èˆµæœºæ§åˆ¶ (äº‘å°/æœºæ¢°è‡‚)                                â”‚
â”‚  - OLED å±å¹•æ˜¾ç¤º                                         â”‚
â”‚  - LED ç¯æ§åˆ¶                                            â”‚
â”‚  - ä¼ æ„Ÿå™¨æ•°æ®é‡‡é›†                                        â”‚
â”‚  - ç”µæ± ç”µå‹ç›‘æµ‹                                          â”‚
â”‚  - ESP-NOW é€šä¿¡ (å¤šæœºååŒ)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†•
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â†“                         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   ç”µæœºé©±åŠ¨    â”‚         â”‚   ä¼ æ„Ÿå™¨     â”‚
    â”‚   (åº•ç›˜)     â”‚         â”‚ - æ¿€å…‰é›·è¾¾   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ - å¤–æ¥ä¼ æ„Ÿå™¨ â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¨¡å—èŒè´£

#### 1. **app.py - ä¸»åº”ç”¨ç¨‹åº**
- **èŒè´£**ï¼šFlask Web æœåŠ¡å™¨ï¼Œç³»ç»Ÿæ ¸å¿ƒè°ƒåº¦
- **ä¸»è¦åŠŸèƒ½**ï¼š
  - æä¾› HTTP æ¥å£ï¼ˆè·¯ç”±ç®¡ç†ï¼‰
  - WebSocket å®æ—¶é€šä¿¡ï¼ˆæ§åˆ¶æŒ‡ä»¤ï¼‰
  - WebRTC è§†é¢‘æµä¼ è¾“
  - æ–‡ä»¶ç®¡ç†ï¼ˆç…§ç‰‡/è§†é¢‘ï¼‰
  - éŸ³é¢‘æ–‡ä»¶ç®¡ç†ä¸æ’­æ”¾æ§åˆ¶
  - ç³»ç»Ÿåˆå§‹åŒ–ä¸å¤šçº¿ç¨‹ç®¡ç†

#### 2. **base_ctrl.py - åº•ç›˜æ§åˆ¶æ¨¡å—**
- **èŒè´£**ï¼šä¸ä¸‹ä½æœº ESP32 çš„é€šä¿¡æ¥å£
- **æ ¸å¿ƒç±»**ï¼š`BaseController`
  - `send_command(data)`ï¼šå‘é€ JSON æŒ‡ä»¤
  - `feedback_data()`ï¼šæ¥æ”¶åº•ç›˜åé¦ˆæ•°æ®
  - `base_speed_ctrl(L, R)`ï¼šåº•ç›˜é€Ÿåº¦æ§åˆ¶
  - `gimbal_ctrl(x, y, spd, acc)`ï¼šäº‘å°æ§åˆ¶
  - `base_oled(line, text)`ï¼šOLED å±å¹•æ˜¾ç¤º
  - `lights_ctrl(pwmA, pwmB)`ï¼šLED ç¯æ§åˆ¶
  - `bus_servo_*`ï¼šæ€»çº¿èˆµæœºæ§åˆ¶
- **ç‰¹æ®ŠåŠŸèƒ½**ï¼š
  - `ReadLine` ç±»ï¼šä¸²å£æ•°æ®è¯»å–ä¸ç¼“å†²
  - ä¼ æ„Ÿå™¨æ•°æ®é‡‡é›†ï¼ˆå¤–æ¥ä¼ æ„Ÿå™¨ï¼‰
  - æ¿€å…‰é›·è¾¾æ•°æ®è§£æ

#### 3. **cv_ctrl.py - è®¡ç®—æœºè§†è§‰æ¨¡å—**
- **èŒè´£**ï¼šæ‘„åƒå¤´å›¾åƒé‡‡é›†ä¸ AI è§†è§‰å¤„ç†
- **æ ¸å¿ƒç±»**ï¼š`OpencvFuncs`
- **è§†è§‰åŠŸèƒ½**ï¼š
  - **è¿åŠ¨æ£€æµ‹**ï¼šåŸºäºå¸§å·®æ³•æ£€æµ‹ç”»é¢å˜åŒ–
  - **äººè„¸è¯†åˆ«**ï¼šHaar Cascade / MediaPipe
  - **ç‰©ä½“è¯†åˆ«**ï¼šMobileNet SSDï¼ˆ20+ ç±»ç‰©ä½“ï¼‰
  - **é¢œè‰²è¿½è¸ª**ï¼šHSV è‰²å½©ç©ºé—´æ£€æµ‹ä¸è¿½è¸ª
  - **æ‰‹åŠ¿è¯†åˆ«**ï¼šMediaPipe Hands
  - **å§¿æ€æ£€æµ‹**ï¼šMediaPipe Pose
  - **è‡ªåŠ¨å·¡çº¿**ï¼šåŸºäºé¢œè‰²çš„çº¿æ¡è¿½è¸ª
- **è¾…åŠ©åŠŸèƒ½**ï¼š
  - ç…§ç‰‡æ‹æ‘„
  - è§†é¢‘å½•åˆ¶
  - å»¶æ—¶æ‘„å½±
  - è‡ªåŠ¨è¿½è¸ªï¼ˆäº‘å°è·Ÿéšç›®æ ‡ï¼‰
  - OSD ä¿¡æ¯å åŠ 

#### 4. **audio_ctrl.py - éŸ³é¢‘æ§åˆ¶æ¨¡å—**
- **èŒè´£**ï¼šéŸ³é¢‘æ’­æ”¾ä¸ TTS è¯­éŸ³åˆæˆ
- **åŠŸèƒ½**ï¼š
  - `play_audio(file)`ï¼šæ’­æ”¾éŸ³é¢‘æ–‡ä»¶ï¼ˆMP3/WAVï¼‰
  - `play_random_audio(dir, force)`ï¼šéšæœºæ’­æ”¾æŒ‡å®šç›®å½•éŸ³é¢‘
  - `play_speech(text)`ï¼šTTS æ–‡æœ¬è½¬è¯­éŸ³
  - `set_audio_volume(vol)`ï¼šéŸ³é‡æ§åˆ¶
- **æŠ€æœ¯æ ˆ**ï¼špygameï¼ˆéŸ³é¢‘æ’­æ”¾ï¼‰ã€pyttsx3ï¼ˆTTSï¼‰

#### 5. **os_info.py - ç³»ç»Ÿä¿¡æ¯æ¨¡å—**
- **èŒè´£**ï¼šå®æ—¶ç›‘æ§ç³»ç»ŸçŠ¶æ€
- **æ ¸å¿ƒç±»**ï¼š`SystemInfo`ï¼ˆçº¿ç¨‹ç±»ï¼‰
- **ç›‘æ§æŒ‡æ ‡**ï¼š
  - CPU è´Ÿè½½ä¸æ¸©åº¦
  - å†…å­˜ä½¿ç”¨ç‡
  - ç½‘ç»œè¿æ¥çŠ¶æ€ï¼ˆä»¥å¤ªç½‘/WiFiï¼‰
  - WiFi ä¿¡å·å¼ºåº¦ï¼ˆRSSIï¼‰
  - WiFi æ¨¡å¼ï¼ˆAP/STAï¼‰
  - ç…§ç‰‡/è§†é¢‘æ–‡ä»¶å¤¹å¤§å°

---

## âš™ï¸ è½¯ä»¶åŠŸèƒ½è¯¦è§£

### 1. Web æ§åˆ¶ç•Œé¢

#### é¡µé¢ç»“æ„
- **index.html**ï¼šä¸»æ§åˆ¶é¡µé¢
  - å®æ—¶è§†é¢‘æ˜¾ç¤º
  - æ–¹å‘é”®æ§åˆ¶
  - é€Ÿåº¦è°ƒèŠ‚
  - åŠŸèƒ½å¿«æ·æŒ‰é’®
  
- **video.html**ï¼šè§†é¢‘ç®¡ç†
  - è§†é¢‘åˆ—è¡¨å±•ç¤º
  - åœ¨çº¿æ’­æ”¾
  - ä¸‹è½½ä¸åˆ é™¤
  
- **photo.html**ï¼šç…§ç‰‡ç®¡ç†
  - ç…§ç‰‡ç¼©ç•¥å›¾
  - æŸ¥çœ‹ä¸åˆ é™¤
  
- **settings.html**ï¼šç³»ç»Ÿè®¾ç½®
  - æœºå™¨äººç±»å‹é…ç½®
  - ç½‘ç»œä¿¡æ¯æŸ¥çœ‹
  - éŸ³é¢‘æ–‡ä»¶ç®¡ç†
  - å‘½ä»¤è¡Œç»ˆç«¯

#### æ§åˆ¶åŠŸèƒ½
- **åº•ç›˜æ§åˆ¶**ï¼šå‰è¿›/åé€€/å·¦è½¬/å³è½¬/åŸåœ°æ—‹è½¬
- **äº‘å°æ§åˆ¶**ï¼šä¸Šä¸‹å·¦å³ä¿¯ä»°/åèˆª
- **æ‘„åƒå¤´åŠŸèƒ½**ï¼š
  - æ‹ç…§ï¼ˆCtrl+Pï¼‰
  - å½•åƒå¼€å§‹/åœæ­¢ï¼ˆCtrl+R / Ctrl+Eï¼‰
  - ç¼©æ”¾åˆ‡æ¢ï¼ˆ1x/2x/4xï¼‰
- **LED ç¯å…‰æ§åˆ¶**ï¼š
  - åº•ç›˜ç¯ï¼šå¼€/å…³/åˆ‡æ¢
  - äº‘å°ç¯ï¼šå…³/è‡ªåŠ¨/å¸¸äº®/åˆ‡æ¢
- **è§†è§‰æ¨¡å¼åˆ‡æ¢**ï¼š
  - æ— ï¼ˆcv_noneï¼‰
  - è¿åŠ¨æ£€æµ‹ï¼ˆcv_motiï¼‰
  - äººè„¸è¯†åˆ«ï¼ˆcv_faceï¼‰
  - ç‰©ä½“è¯†åˆ«ï¼ˆcv_objsï¼‰
  - é¢œè‰²è¿½è¸ªï¼ˆcv_clorï¼‰
  - è‡ªåŠ¨å·¡çº¿ï¼ˆcv_autoï¼‰
  - æ‰‹åŠ¿è¯†åˆ«ï¼ˆmp_handï¼‰
  - å§¿æ€æ£€æµ‹ï¼ˆmp_poseï¼‰
- **æ£€æµ‹ååº”æ¨¡å¼**ï¼š
  - æ— ååº”ï¼ˆre_noneï¼‰
  - è‡ªåŠ¨æ‹ç…§ï¼ˆre_captï¼‰
  - è‡ªåŠ¨å½•åƒï¼ˆre_recoï¼‰
- **è¿åŠ¨é”å®š**ï¼šå¼€å¯åäº‘å°è‡ªåŠ¨è¿½è¸ªæ£€æµ‹ç›®æ ‡

### 2. å‘½ä»¤è¡Œç³»ç»Ÿ

åœ¨ Web è®¾ç½®é¡µé¢å¯ä½¿ç”¨å‘½ä»¤è¡Œç»ˆç«¯ï¼Œæ”¯æŒä»¥ä¸‹å‘½ä»¤ï¼š

#### base - åº•ç›˜æ§åˆ¶
```bash
# å‘é€ JSON æŒ‡ä»¤
base -c {"T":1,"L":0.5,"R":0.5}

# æ˜¾ç¤ºæ¥æ”¶ä¿¡æ¯
base -r on
base -r off
```

#### audio - éŸ³é¢‘æ§åˆ¶
```bash
# TTS è¯­éŸ³åˆæˆ
audio -s Hello World

# è®¾ç½®éŸ³é‡ (0-1)
audio -v 0.8

# æ’­æ”¾éŸ³é¢‘æ–‡ä»¶
audio -p others/test.mp3
```

#### cv - è§†è§‰å‚æ•°è°ƒæ•´
```bash
# è®¾ç½®é¢œè‰²èŒƒå›´ (HSV)
cv -r [100,50,50] [120,255,255]

# é€‰æ‹©é¢„è®¾é¢œè‰²
cv -s red
cv -s blue
cv -s green
```

#### video - è§†é¢‘è´¨é‡
```bash
# è®¾ç½®è§†é¢‘è´¨é‡ (1-100)
video -q 30
```

#### line - å·¡çº¿å‚æ•°
```bash
# è®¾ç½®å·¡çº¿é¢œè‰²èŒƒå›´
line -r [0,0,0] [180,255,50]

# è®¾ç½®å·¡çº¿ PID å‚æ•°
line -s 0.7 0.8 1.6 0.0006 0.6 0.4 0.2
```

#### timelapse - å»¶æ—¶æ‘„å½±
```bash
# å¯åŠ¨å»¶æ—¶æ‘„å½±
# å‚æ•°ï¼šç§»åŠ¨é€Ÿåº¦ ç§»åŠ¨æ—¶é—´ æ‹æ‘„é—´éš” å¾ªç¯æ¬¡æ•°
timelapse -s 0.2 1 2 10

# åœæ­¢å»¶æ—¶æ‘„å½±
timelapse -e
```

#### send - ESP-NOW é€šä¿¡
```bash
# æ·»åŠ å¹¿æ’­åœ°å€
send -a -b

# ç§»é™¤å¹¿æ’­åœ°å€
send -rm -b

# å¹¿æ’­æ¶ˆæ¯
send -b Hello everyone

# ç»„æ’­æ¶ˆæ¯
send -g Hello group

# ç‚¹å¯¹ç‚¹å‘é€
send [MACåœ°å€] Hello robot
```

#### s - æœºå™¨äººç±»å‹è®¾ç½®
```bash
# æ ¼å¼ï¼šs [ä¸»ç±»å‹][æ¨¡å—ç±»å‹]
# ä¸»ç±»å‹ï¼š1=RaspRover 2=UGV Rover 3=UGV Beast
# æ¨¡å—ç±»å‹ï¼š0=æ—  1=æœºæ¢°è‡‚ 2=äº‘å°
s 22  # UGV Rover + äº‘å°
s 11  # RaspRover + æœºæ¢°è‡‚
s 30  # UGV Beast + æ— æ¨¡å—
```

### 3. JSON é€šä¿¡åè®®

ä¸Šä¸‹ä½æœºé€šè¿‡ UART ä¼ è¾“ JSON æ ¼å¼æŒ‡ä»¤ï¼š

#### å¸¸ç”¨æŒ‡ä»¤ç±»å‹ï¼ˆT å­—æ®µï¼‰
- **T:1** - åº•ç›˜é€Ÿåº¦æ§åˆ¶
  ```json
  {"T":1,"L":0.5,"R":0.5}
  ```
- **T:3** - OLED æ˜¾ç¤º
  ```json
  {"T":3,"lineNum":0,"Text":"Hello"}
  ```
- **T:4** - é€‰æ‹©æ¨¡å—
  ```json
  {"T":4,"cmd":2}
  ```
- **T:11** - PWM æ§åˆ¶
  ```json
  {"T":11,"IO1":128,"IO2":255}
  ```
- **T:132** - LED ç¯æ§åˆ¶
  ```json
  {"T":132,"IO4":255,"IO5":128}
  ```
- **T:133** - äº‘å°æ§åˆ¶
  ```json
  {"T":133,"X":0,"Y":0,"SPD":200,"ACC":10}
  ```
- **T:141** - äº‘å°åŸºç¡€æ§åˆ¶
  ```json
  {"T":141,"X":90,"Y":-30,"SPD":50}
  ```
- **T:144** - æœºæ¢°è‡‚ UI æ§åˆ¶
  ```json
  {"T":144,"E":60,"Z":24,"R":0}
  ```

#### åé¦ˆæ•°æ®æ ¼å¼
```json
{
  "T":1001,
  "L":0,
  "R":0,
  "r":0,
  "p":0,
  "v":11.5,
  "pan":0,
  "tilt":0
}
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç³»ç»Ÿè¦æ±‚
- ç¡¬ä»¶ï¼šæ ‘è“æ´¾ 4B/5 (æ¨è 4GB+ å†…å­˜)
- ç³»ç»Ÿï¼šRaspberry Pi OS (Debian-based)
- Pythonï¼š3.11+
- æ‘„åƒå¤´ï¼šCSI æ‘„åƒå¤´æˆ– USB æ‘„åƒå¤´

### å®‰è£…æ­¥éª¤

#### 1. å…‹éš†ä»“åº“
```bash
git clone https://github.com/waveshareteam/ugv_rpi.git
cd ugv_rpi/
```

#### 2. æˆäºˆæ‰§è¡Œæƒé™
```bash
sudo chmod +x setup.sh
sudo chmod +x autorun.sh
```

#### 3. è¿è¡Œå®‰è£…è„šæœ¬ï¼ˆéœ€è¦ä¸€æ®µæ—¶é—´ï¼‰
```bash
sudo ./setup.sh
```

#### 4. é…ç½®å¼€æœºè‡ªå¯åŠ¨
```bash
./autorun.sh
```

#### 5. å®‰è£… AccessPopupï¼ˆWiFi çƒ­ç‚¹å·¥å…·ï¼‰
```bash
cd AccessPopup
sudo chmod +x installconfig.sh
sudo ./installconfig.sh
# è¾“å…¥ 1 å®‰è£…
# è¾“å…¥ 9 é€€å‡º
```

#### 6. é‡å¯è®¾å¤‡
```bash
sudo reboot
```

### é¦–æ¬¡è¿è¡Œ

1. **æœºå™¨äººå¯åŠ¨**ï¼šä¸Šç”µåï¼Œæ ‘è“æ´¾è‡ªåŠ¨åˆå§‹åŒ–ï¼ŒOLED å±å¹•æ˜¾ç¤ºç³»ç»Ÿä¿¡æ¯ï¼š
   ```
   E: 192.168.1.100      # ä»¥å¤ªç½‘ IP
   W: 192.168.50.5       # WiFi IP
   F/J: 5000/8888        # Webç«¯å£ / JupyterLabç«¯å£
   STA 00:15:32 -45dBm   # WiFiæ¨¡å¼ è¿è¡Œæ—¶é—´ ä¿¡å·å¼ºåº¦
   ```

2. **è¿æ¥ WiFi**ï¼š
   - **AP æ¨¡å¼**ï¼ˆé»˜è®¤ï¼‰ï¼šè¿æ¥çƒ­ç‚¹ `AccessPopup`ï¼Œå¯†ç  `1234567890`
   - **STA æ¨¡å¼**ï¼šæœºå™¨äººè¿æ¥å·²çŸ¥ WiFiï¼Œè®°ä¸‹å±å¹•æ˜¾ç¤ºçš„ IP

3. **è®¿é—®æ§åˆ¶ç•Œé¢**ï¼š
   - æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥ `http://[IP]:5000`
   - ä¾‹å¦‚ï¼š`http://192.168.50.5:5000`

4. **é…ç½®æœºå™¨äººç±»å‹**ï¼š
   åœ¨è®¾ç½®é¡µé¢çš„å‘½ä»¤è¡Œè¾“å…¥ï¼š
   ```bash
   s 22  # UGV Rover + äº‘å°
   ```

5. **è®¿é—® JupyterLab æ•™ç¨‹**ï¼š
   - æµè§ˆå™¨è¾“å…¥ `http://[IP]:8888`
   - è¿›å…¥ `tutorial_cn` ç›®å½•å­¦ä¹ æ•™ç¨‹

---

## ğŸ› ï¸ äºŒæ¬¡å¼€å‘æŒ‡å—

### å¼€å‘ç¯å¢ƒé…ç½®

#### 1. æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
```bash
cd ~/ugv_rpi
source ugv-env/bin/activate
```

#### 2. å®‰è£…å¼€å‘å·¥å…·
```bash
pip install ipython jupyter
```

#### 3. æµ‹è¯•è¿è¡Œ
```bash
python app.py
```

### æ¨¡å—å¼€å‘ç¤ºä¾‹

#### ç¤ºä¾‹ 1ï¼šæ·»åŠ è‡ªå®šä¹‰ CV åŠŸèƒ½

ç¼–è¾‘ `cv_ctrl.py`ï¼Œåœ¨ `OpencvFuncs` ç±»ä¸­æ·»åŠ ï¼š

```python
def my_custom_detection(self, frame):
    """
    è‡ªå®šä¹‰æ£€æµ‹åŠŸèƒ½
    """
    # ä½ çš„å¤„ç†é€»è¾‘
    processed_frame = frame.copy()
    
    # ç¤ºä¾‹ï¼šåœ¨ç”»é¢ä¸­å¿ƒç»˜åˆ¶ä¸€ä¸ªåœ†
    h, w = frame.shape[:2]
    cv2.circle(processed_frame, (w//2, h//2), 50, (0, 255, 0), 2)
    
    return processed_frame
```

åœ¨ `frame_process()` æ–¹æ³•ä¸­è°ƒç”¨ï¼š
```python
def frame_process(self):
    # ... ç°æœ‰ä»£ç  ...
    if self.cv_mode == 10310:  # è‡ªå®šä¹‰æ¨¡å¼ä»£ç 
        frame = self.my_custom_detection(frame)
    # ... ç°æœ‰ä»£ç  ...
```

åœ¨ `config.yaml` ä¸­æ·»åŠ ä»£ç ï¼š
```yaml
code:
  my_custom: 10310
```

åœ¨ `app.py` ä¸­æ·»åŠ æŒ‡ä»¤æ˜ å°„ï¼š
```python
cmd_actions = {
    # ... ç°æœ‰ä»£ç  ...
    f['code']['my_custom']: lambda: cvf.set_cv_mode(f['code']['my_custom']),
}
```

#### ç¤ºä¾‹ 2ï¼šæ·»åŠ æ–°çš„åº•ç›˜æ§åˆ¶æŒ‡ä»¤

åœ¨ `base_ctrl.py` ä¸­æ·»åŠ ï¼š

```python
def my_custom_motion(self, speed, angle):
    """
    è‡ªå®šä¹‰è¿åŠ¨æ§åˆ¶
    å‚æ•°ï¼š
        speed: é€Ÿåº¦ (0-1)
        angle: è§’åº¦ (0-360)
    """
    data = {
        "T": 999,  # è‡ªå®šä¹‰æŒ‡ä»¤ç±»å‹
        "spd": speed,
        "ang": angle
    }
    self.send_command(data)
```

åœ¨ `app.py` çš„å‘½ä»¤è¡Œç³»ç»Ÿä¸­æ·»åŠ ï¼š

```python
def cmdline_ctrl(args_string):
    # ... ç°æœ‰ä»£ç  ...
    elif args[0] == 'move':
        if args[1] == '-c':
            speed = float(args[2])
            angle = float(args[3])
            base.my_custom_motion(speed, angle)
```

#### ç¤ºä¾‹ 3ï¼šæ·»åŠ æ–°çš„ Web API æ¥å£

åœ¨ `app.py` ä¸­æ·»åŠ ï¼š

```python
@app.route('/api/custom_action', methods=['POST'])
def custom_action():
    """
    è‡ªå®šä¹‰ API æ¥å£
    """
    data = request.get_json()
    param1 = data.get('param1')
    param2 = data.get('param2')
    
    # æ‰§è¡Œè‡ªå®šä¹‰é€»è¾‘
    result = your_custom_function(param1, param2)
    
    return jsonify({
        "status": "success",
        "result": result
    })
```

å‰ç«¯è°ƒç”¨ç¤ºä¾‹ï¼ˆåœ¨ `templates/main.js` ä¸­ï¼‰ï¼š
```javascript
async function callCustomAction(param1, param2) {
    const response = await fetch('/api/custom_action', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({param1, param2})
    });
    const data = await response.json();
    console.log(data);
}
```

### é…ç½®æ–‡ä»¶è¯´æ˜

`config.yaml` æ˜¯ç³»ç»Ÿçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼š

#### ä¸»è¦é…ç½®é¡¹

```yaml
base_config:
  robot_name: RaspRover        # æœºå™¨äººåç§°
  main_type: 1                 # ä¸»ç±»å‹ (1:RaspRover 2:UGV Rover 3:UGV Beast)
  module_type: 0               # æ¨¡å—ç±»å‹ (0:æ—  1:æœºæ¢°è‡‚ 2:äº‘å°)
  sbc_version: 0.93            # ä¸Šä½æœºç¨‹åºç‰ˆæœ¬
  use_lidar: false             # æ˜¯å¦ä½¿ç”¨æ¿€å…‰é›·è¾¾
  extra_sensor: false          # æ˜¯å¦ä½¿ç”¨å¤–æ¥ä¼ æ„Ÿå™¨
  add_osd: false               # æ˜¯å¦æ·»åŠ  OSD ä¿¡æ¯

args_config:
  max_speed: 0.65              # æœ€å¤§é€Ÿåº¦
  slow_speed: 0.3              # æ…¢é€Ÿ
  max_rate: 1.0                # æœ€å¤§é€Ÿç‡
  mid_rate: 0.66               # ä¸­é€Ÿç‡
  min_rate: 0.3                # æœ€å°é€Ÿç‡
  arm_default_e: 60            # æœºæ¢°è‡‚é»˜è®¤ E è½´ä½ç½®
  arm_default_z: 24            # æœºæ¢°è‡‚é»˜è®¤ Z è½´ä½ç½®
  arm_default_r: 0             # æœºæ¢°è‡‚é»˜è®¤ R è½´ä½ç½®

video:
  default_res_w: 640           # é»˜è®¤è§†é¢‘å®½åº¦
  default_res_h: 480           # é»˜è®¤è§†é¢‘é«˜åº¦
  default_quality: 20          # é»˜è®¤è§†é¢‘è´¨é‡ (1-100)

audio_config:
  audio_output: true           # æ˜¯å¦å¯ç”¨éŸ³é¢‘è¾“å‡º
  default_volume: 1.0          # é»˜è®¤éŸ³é‡ (0-1)
  speed_rate: 180              # TTS è¯­é€Ÿ
  min_time_bewteen_play: 1     # éŸ³é¢‘æ’­æ”¾æœ€å°é—´éš”ï¼ˆç§’ï¼‰

cv:
  default_color: blue          # é»˜è®¤è¿½è¸ªé¢œè‰²
  color_lower: [101, 50, 38]   # HSV ä¸‹ç•Œ
  color_upper: [110, 255, 255] # HSV ä¸Šç•Œ
  min_radius: 12               # æœ€å°æ£€æµ‹åŠå¾„
  aimed_error: 8               # ç„å‡†è¯¯å·®å®¹é™
  track_spd_rate: 60           # è¿½è¸ªé€Ÿåº¦å€ç‡
  track_acc_rate: 0.4          # è¿½è¸ªåŠ é€Ÿåº¦å€ç‡
  track_color_iterate: 0.023   # é¢œè‰²è¿½è¸ªè¿­ä»£é€Ÿåº¦
  track_faces_iterate: 0.045   # äººè„¸è¿½è¸ªè¿­ä»£é€Ÿåº¦
  sampling_rad: 25             # é‡‡æ ·åŠå¾„

code:
  # åŠŸèƒ½ä»£ç å®šä¹‰
  cv_none: 10301
  cv_moti: 10302
  cv_face: 10303
  # ... æ›´å¤šä»£ç  ...

cmd_config:
  # æŒ‡ä»¤ç±»å‹å®šä¹‰
  cmd_movition_ctrl: 1
  cmd_gimbal_ctrl: 133
  cmd_gimbal_base_ctrl: 141
  # ... æ›´å¤šæŒ‡ä»¤ ...

fb:
  # åé¦ˆå­—æ®µå®šä¹‰
  detect_type: 101
  led_mode: 102
  detect_react: 103
  # ... æ›´å¤šå­—æ®µ ...
```

### è°ƒè¯•æŠ€å·§

#### 1. æŸ¥çœ‹å®æ—¶æ—¥å¿—
```bash
# æŸ¥çœ‹ä¸»ç¨‹åºè¾“å‡º
journalctl -u your_service_name -f

# æˆ–ç›´æ¥è¿è¡ŒæŸ¥çœ‹è¾“å‡º
cd ~/ugv_rpi
source ugv-env/bin/activate
python app.py
```

#### 2. æµ‹è¯•åº•ç›˜é€šä¿¡
```python
from base_ctrl import BaseController
import time

base = BaseController('/dev/serial0', 115200)

# æµ‹è¯• OLED
base.base_oled(0, "Test Line 1")
base.base_oled(1, "Test Line 2")

# æµ‹è¯•è¿åŠ¨
base.base_speed_ctrl(0.3, 0.3)  # å‰è¿›
time.sleep(2)
base.base_speed_ctrl(0, 0)      # åœæ­¢

base.gimbal_dev_close()
```

#### 3. æµ‹è¯•è§†è§‰åŠŸèƒ½
```python
from cv_ctrl import OpencvFuncs
from base_ctrl import BaseController

base = BaseController('/dev/serial0', 115200)
cvf = OpencvFuncs('.', base)

# è®¾ç½®æ£€æµ‹æ¨¡å¼
cvf.set_cv_mode(10303)  # äººè„¸è¯†åˆ«

# è·å–ä¸€å¸§å›¾åƒ
frame = cvf.frame_process()
```

#### 4. å¸¸è§é—®é¢˜æ’æŸ¥

**é—®é¢˜ï¼šæ‘„åƒå¤´æ— æ³•æ‰“å¼€**
```bash
# æ£€æŸ¥æ‘„åƒå¤´è®¾å¤‡
ls /dev/video*

# æµ‹è¯• libcamera
libcamera-hello

# æ£€æŸ¥ Picamera2
python -c "from picamera2 import Picamera2; print('OK')"
```

**é—®é¢˜ï¼šä¸²å£é€šä¿¡å¤±è´¥**
```bash
# æ£€æŸ¥ä¸²å£è®¾å¤‡
ls /dev/serial* /dev/ttyAMA* /dev/ttyUSB*

# æ£€æŸ¥ä¸²å£æƒé™
sudo usermod -a -G dialout $USER

# æµ‹è¯•ä¸²å£
python -c "import serial; s=serial.Serial('/dev/serial0',115200); print(s)"
```

**é—®é¢˜ï¼šv4l2.py é”™è¯¯**
```bash
# åˆ é™¤è™šæ‹Ÿç¯å¢ƒä¸­çš„ v4l2.py
rm ~/ugv_rpi/ugv-env/lib/python3.11/site-packages/v4l2.py
rm ~/.local/lib/python3.11/site-packages/v4l2.py
```

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

#### 1. è§†é¢‘æ€§èƒ½ä¼˜åŒ–
- é™ä½åˆ†è¾¨ç‡ï¼šåœ¨ `config.yaml` ä¿®æ”¹ `video.default_res_w/h`
- è°ƒæ•´è´¨é‡ï¼šé™ä½ `video.default_quality` å€¼
- ç¦ç”¨ä¸éœ€è¦çš„ CV åŠŸèƒ½

#### 2. CPU è´Ÿè½½ä¼˜åŒ–
```python
# åœ¨ cv_ctrl.py ä¸­æ·»åŠ å¸§ç‡é™åˆ¶
import time
frame_interval = 1.0 / 30  # 30 FPS
last_frame_time = time.time()

def frame_process(self):
    current_time = time.time()
    if current_time - last_frame_time < frame_interval:
        time.sleep(frame_interval - (current_time - last_frame_time))
    last_frame_time = time.time()
    # ... åŸæœ‰ä»£ç  ...
```

#### 3. å†…å­˜ä¼˜åŒ–
- å®šæœŸæ¸…ç†ç…§ç‰‡/è§†é¢‘æ–‡ä»¶
- é™åˆ¶ deque ç¼“å†²åŒºå¤§å°
- ä½¿ç”¨ numpy è§†å›¾è€Œéæ‹·è´

---

## ğŸ“¦ ä¾èµ–åº“è¯´æ˜

### æ ¸å¿ƒä¾èµ–
- **Flask** (2.2.2)ï¼šWeb æ¡†æ¶
- **Flask-SocketIO** (5.3.6)ï¼šWebSocket æ”¯æŒ
- **opencv-contrib-python** (4.9.0.80)ï¼šè®¡ç®—æœºè§†è§‰
- **mediapipe** (0.10.9)ï¼šAI æ‰‹åŠ¿/å§¿æ€è¯†åˆ«
- **aiortc** (1.8.0)ï¼šWebRTC å®æ—¶é€šä¿¡
- **picamera2** (0.3.17)ï¼šæ ‘è“æ´¾æ‘„åƒå¤´æ¥å£
- **pyserial** (3.5)ï¼šä¸²å£é€šä¿¡
- **PyYAML** (6.0.1)ï¼šé…ç½®æ–‡ä»¶è§£æ

### AI ç›¸å…³
- **torch** (2.1.0)ï¼šæ·±åº¦å­¦ä¹ æ¡†æ¶
- **numpy** (1.24.2)ï¼šæ•°å€¼è®¡ç®—
- **imutils** (0.5.4)ï¼šå›¾åƒå¤„ç†å·¥å…·

### éŸ³é¢‘ç›¸å…³
- **pygame** (2.1.2)ï¼šéŸ³é¢‘æ’­æ”¾
- **pyttsx3** (2.7)ï¼šTTS è¯­éŸ³åˆæˆ
- **gTTS** (2.4.0)ï¼šGoogle TTS

### ç³»ç»Ÿç›¸å…³
- **psutil** (5.9.4)ï¼šç³»ç»Ÿä¿¡æ¯è·å–
- **netifaces** (0.11.0)ï¼šç½‘ç»œæ¥å£ç®¡ç†

å®Œæ•´ä¾èµ–åˆ—è¡¨è§ `requirements.txt`ã€‚

---

## ğŸ“ å­¦ä¹ èµ„æº

### JupyterLab æ•™ç¨‹

æœ¬é¡¹ç›®åŒ…å« 29 ä¸ªè¯¦ç»†çš„äº¤äº’å¼æ•™ç¨‹ï¼ˆ`tutorial_cn/`ï¼‰ï¼Œæ¶µç›–ï¼š

1. **åŸºç¡€ç¯‡**ï¼šJupyterLab ä½¿ç”¨ã€Python åŸºç¡€
2. **æ§åˆ¶ç¯‡**ï¼šåº•ç›˜è¿åŠ¨ã€äº‘å°æ§åˆ¶ã€LED/OLED æ§åˆ¶
3. **é€šä¿¡ç¯‡**ï¼šä¸²å£é€šä¿¡ã€JSON æŒ‡ä»¤ã€åé¦ˆæ•°æ®
4. **è§†è§‰ç¯‡**ï¼šOpenCV åŸºç¡€ã€äººè„¸/ç‰©ä½“/é¢œè‰²è¯†åˆ«
5. **AI ç¯‡**ï¼šMediaPipe æ‰‹åŠ¿/å§¿æ€æ£€æµ‹
6. **åº”ç”¨ç¯‡**ï¼šå»¶æ—¶æ‘„å½±ã€è‡ªåŠ¨å·¡çº¿ã€Flask åº”ç”¨

### è®¿é—®æ•™ç¨‹
```
http://[æœºå™¨äººIP]:8888
```
è¿›å…¥ `tutorial_cn` ç›®å½•ï¼ŒæŒ‰é¡ºåºå­¦ä¹ ã€‚

---

## ğŸ“ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ **GNU General Public License v3.0** è®¸å¯è¯ã€‚

Copyright (C) 2024 [Waveshare](https://www.waveshare.com/)

---

## ğŸ”— ç›¸å…³é“¾æ¥

- **ä¸‹ä½æœºç¨‹åº**ï¼š
  - [ugv_base_ros](https://github.com/effectsmachine/ugv_base_ros)
  - [ugv_base_general](https://github.com/effectsmachine/ugv_base_general)
- **å®˜æ–¹ä»“åº“**ï¼š[https://github.com/waveshareteam/ugv_rpi](https://github.com/waveshareteam/ugv_rpi)
- **Waveshare å®˜ç½‘**ï¼š[https://www.waveshare.com/](https://www.waveshare.com/)

---

## ğŸ“§ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·è®¿é—® Waveshare å®˜ç½‘æˆ–æäº¤ GitHub Issueã€‚

---

## ğŸ¯ å¿«é€Ÿå‚è€ƒ

### å¸¸ç”¨ç«¯å£
- **Web æ§åˆ¶**ï¼š5000
- **JupyterLab**ï¼š8888

### é»˜è®¤è´¦å·
- **WiFi çƒ­ç‚¹**ï¼š`AccessPopup` / `1234567890`
- **JupyterLab**ï¼šæ— å¯†ç ï¼ˆé¦–æ¬¡è®¿é—®è®¾ç½®ï¼‰

### å¿«æ·é”®ï¼ˆWeb ç•Œé¢ï¼‰
- **Ctrl + P**ï¼šæ‹ç…§
- **Ctrl + R**ï¼šå¼€å§‹å½•åƒ
- **Ctrl + E**ï¼šåœæ­¢å½•åƒ
- **æ–¹å‘é”®**ï¼šåº•ç›˜æ§åˆ¶
- **WASD**ï¼šäº‘å°æ§åˆ¶

### å¼€å‘è°ƒè¯•
```bash
# æ¿€æ´»ç¯å¢ƒ
cd ~/ugv_rpi && source ugv-env/bin/activate

# è¿è¡Œä¸»ç¨‹åº
python app.py

# è¿è¡Œ JupyterLab
jupyter lab --ip=0.0.0.0 --port=8888 --no-browser

# æŸ¥çœ‹ä¸²å£æ•°æ®
python -c "from base_ctrl import *; bc=BaseController('/dev/serial0',115200); import time; time.sleep(1); print(bc.feedback_data())"
```

---

**æœ¬æ–‡æ¡£æŒç»­æ›´æ–°ä¸­...**

æœ€åæ›´æ–°æ—¶é—´ï¼š2024-11

